{"ast":null,"code":"var _jsxFileName = \"/Users/boris/sei-bromeliad/projects/project4/Project-4-Frontend/src/App.js\";\nimport './App.css';\nimport React, { Component } from 'react';\nimport NewForm from './NewForm';\nimport Nav from './Nav';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet baseUrl = \"http://localhost:8000/api/v1/home/\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n\n    this.getHolidays = () => {\n      // fetch to the backend\n      fetch(baseUrl + \"/holidays\", {\n        credentials: \"include\"\n      }).then(res => {\n        if (res.status === 200) {\n          return res.json();\n        } else {\n          return [];\n        }\n      }).then(data => {\n        console.log(data);\n        this.setState({\n          holidays: data\n        });\n      });\n    };\n\n    this.addHoliday = newHoliday => {\n      const copyHolidays = [...this.state.holidays];\n      copyHolidays.push(newHoliday);\n      this.setState({\n        holidays: copyHolidays\n      });\n    };\n\n    this.loginUser = async e => {\n      console.log('loginUser');\n      e.preventDefault();\n      const url = baseUrl + '/users/login';\n      const loginBody = {\n        username: e.target.username.value,\n        password: e.target.password.value\n      };\n\n      try {\n        const response = await fetch(url, {\n          method: 'POST',\n          body: JSON.stringify(loginBody),\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          credentials: \"include\"\n        });\n        console.log(response);\n        console.log(\"BODY: \", response.body);\n\n        if (response.status === 200) {\n          this.getHolidays();\n        }\n      } catch (err) {\n        console.log('Error => ', err);\n      }\n    };\n\n    this.register = async e => {\n      e.preventDefault();\n      const url = baseUrl + '/users/signup';\n\n      try {\n        const response = await fetch(url, {\n          method: 'POST',\n          body: JSON.stringify({\n            username: e.target.username.value,\n            password: e.target.password.value\n          }),\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n\n        if (response.status === 200) {\n          this.getHolidays();\n        }\n      } catch (err) {\n        console.log('Error => ', err);\n      }\n    };\n\n    this.toggleCelebrated = holiday => {\n      // console.log(holiday)\n      fetch(baseUrl + '/holidays/' + holiday._id, {\n        method: 'PUT',\n        body: JSON.stringify({\n          celebrated: !holiday.celebrated\n        }),\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: \"include\"\n      }).then(res => res.json()).then(resJson => {\n        // console.log(resJson)\n        const copyHolidays = [...this.state.holidays];\n        const findIndex = this.state.holidays.findIndex(holiday => holiday._id === resJson._id);\n        copyHolidays[findIndex].celebrated = resJson.celebrated;\n        this.setState({\n          holidays: copyHolidays\n        });\n      });\n    };\n\n    this.deleteHoliday = id => {\n      // console.log(id)\n      fetch(baseUrl + '/holidays/' + id, {\n        method: 'DELETE',\n        credentials: \"include\"\n      }).then(res => {\n        // console.log(res)\n        // if I checked for a 200 response code\n        const findIndex = this.state.holidays.findIndex(holiday => holiday._id === id);\n        const copyHolidays = [...this.state.holidays];\n        copyHolidays.splice(findIndex, 1);\n        this.setState({\n          holidays: copyHolidays\n        });\n      });\n    };\n\n    this.addLike = holiday => {\n      // console.log(holiday)\n      fetch(baseUrl + '/holidays/' + holiday._id, {\n        method: 'PUT',\n        body: JSON.stringify({\n          likes: holiday.likes + 1\n        }),\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: \"include\"\n      }).then(res => res.json()).then(resJson => {\n        // console.log(resJson)\n        const copyHolidays = [...this.state.holidays];\n        const findIndex = this.state.holidays.findIndex(holiday => holiday._id === resJson._id);\n        copyHolidays[findIndex].likes = resJson.likes;\n        this.setState({\n          holidays: copyHolidays\n        });\n      });\n    };\n\n    this.handleSubmit = async e => {\n      e.preventDefault();\n      const url = baseUrl + '/holidays/' + this.state.holidayToBeEdited._id;\n\n      try {\n        const response = await fetch(url, {\n          method: 'PUT',\n          body: JSON.stringify({\n            name: e.target.name.value,\n            description: e.target.description.value\n          }),\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          credentials: \"include\"\n        });\n\n        if (response.status === 200) {\n          const updatedHoliday = await response.json(); //console.log(updatedHoliday)\n\n          const findIndex = this.state.holidays.findIndex(holiday => holiday._id === updatedHoliday._id);\n          const copyHolidays = [...this.state.holidays];\n          copyHolidays[findIndex] = updatedHoliday;\n          this.setState({\n            holidays: copyHolidays,\n            modalOpen: false\n          });\n        }\n      } catch (err) {\n        console.log('Error => ', err);\n      }\n    };\n\n    this.handleChange = e => {\n      this.setState({\n        [e.target.name]: e.target.value\n      });\n    };\n\n    this.showEditForm = holiday => {\n      this.setState({\n        modalOpen: true,\n        name: holiday.name,\n        description: holiday.description,\n        holidayToBeEdited: holiday\n      });\n    };\n\n    this.state = {\n      holidays: [],\n      modalOpen: false,\n      holidayToBeEdited: {},\n      description: '',\n      name: '',\n      userLoggedIn: false\n    }; //if you do not use an arrow function for getHolidays()\n    // this.getHolidays = this.getHolidays.bind(this)\n  }\n\n  // component lifecycle flowchart\n  // https://levelup.gitconnected.com/componentdidmakesense-react-lifecycle-explanation-393dcb19e459\n  componentDidMount() {\n    this.getHolidays();\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"App\",\n      children: [/*#__PURE__*/_jsxDEV(Nav, {\n        loginUser: this.loginUser,\n        register: this.register\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"Holidays! Celebrate! \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(NewForm, {\n        baseUrl: baseUrl,\n        addHoliday: this.addHoliday\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n        children: /*#__PURE__*/_jsxDEV(\"tbody\", {\n          children: this.state.holidays.map((holiday, i) => {\n            return /*#__PURE__*/_jsxDEV(\"tr\", {\n              children: [/*#__PURE__*/_jsxDEV(\"td\", {\n                onDoubleClick: () => this.toggleCelebrated(holiday),\n                className: holiday.celebrated ? 'celebrated' : null,\n                children: holiday.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 232,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: [\" \", holiday.description, \" \"]\n              }, i, true, {\n                fileName: _jsxFileName,\n                lineNumber: 236,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                children: holiday.likes\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 237,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                onClick: () => {\n                  this.addLike(holiday);\n                },\n                children: \"LIKE\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 238,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                onClick: () => {\n                  this.showEditForm(holiday);\n                },\n                children: \"Show Edit Form\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 239,\n                columnNumber: 21\n              }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n                onClick: () => this.deleteHoliday(holiday._id),\n                children: \"X\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 240,\n                columnNumber: 21\n              }, this)]\n            }, holiday._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 231,\n              columnNumber: 19\n            }, this);\n          })\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 9\n      }, this), this.state.modalOpen && /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: this.handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Name: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"name\",\n          value: this.state.name,\n          onChange: this.handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 15\n        }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 89\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          children: \"Description: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 255,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"description\",\n          value: this.state.description,\n          onChange: this.handleChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 256,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          children: \"submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 258,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default App;","map":{"version":3,"sources":["/Users/boris/sei-bromeliad/projects/project4/Project-4-Frontend/src/App.js"],"names":["React","Component","NewForm","Nav","baseUrl","App","constructor","props","getHolidays","fetch","credentials","then","res","status","json","data","console","log","setState","holidays","addHoliday","newHoliday","copyHolidays","state","push","loginUser","e","preventDefault","url","loginBody","username","target","value","password","response","method","body","JSON","stringify","headers","err","register","toggleCelebrated","holiday","_id","celebrated","resJson","findIndex","deleteHoliday","id","splice","addLike","likes","handleSubmit","holidayToBeEdited","name","description","updatedHoliday","modalOpen","handleChange","showEditForm","userLoggedIn","componentDidMount","render","map","i"],"mappings":"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","sourcesContent":["import './App.css';\nimport React, { Component } from 'react'\nimport NewForm from './NewForm'\nimport Nav from './Nav'\n\nlet baseUrl = \"http://localhost:8000/api/v1/home/\"\n\nclass App extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      holidays: [],\n      modalOpen: false,\n      holidayToBeEdited:{},\n      description:'',\n      name: '',\n      userLoggedIn: false\n    }\n    //if you do not use an arrow function for getHolidays()\n    // this.getHolidays = this.getHolidays.bind(this)\n  }\n\n  getHolidays = () => {\n    // fetch to the backend\n    fetch(baseUrl + \"/holidays\",{\n      credentials: \"include\"\n    })\n    .then(res => {\n      if(res.status === 200) {\n        return res.json()\n      } else {\n        return []\n      }\n    }).then(data => {\n      console.log(data)\n      this.setState({ holidays: data })\n    })\n  }\n\n  addHoliday = (newHoliday) => {\n    const copyHolidays = [...this.state.holidays]\n    copyHolidays.push(newHoliday)\n    this.setState({\n      holidays: copyHolidays,\n    })\n  }\n\n  loginUser = async (e) => {\n    console.log('loginUser')\n    e.preventDefault()\n    const url = baseUrl + '/users/login'\n    const loginBody = {\n      username: e.target.username.value,\n      password: e.target.password.value\n    }\n    try {\n\n      const response = await fetch(url, {\n        method: 'POST',\n        body: JSON.stringify(loginBody),\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        credentials: \"include\"\n      })\n\n      console.log(response)\n      console.log(\"BODY: \",response.body)\n\n      if (response.status === 200) {\n        this.getHolidays()\n      }\n    }\n    catch (err) {\n      console.log('Error => ', err);\n    }\n  }\n\n  register = async (e) => {\n    e.preventDefault()\n    const url = baseUrl + '/users/signup'\n    try {\n      const response = await fetch(url, {\n        method: 'POST',\n        body: JSON.stringify({\n          username: e.target.username.value,\n          password: e.target.password.value\n        }),\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      })\n      if (response.status === 200) {\n        this.getHolidays()\n      }\n    }\n    catch (err) {\n      console.log('Error => ', err);\n    }\n  }\n\n\n  toggleCelebrated = (holiday) => {\n    // console.log(holiday)\n    fetch(baseUrl + '/holidays/' + holiday._id, {\n      method: 'PUT',\n      body: JSON.stringify({celebrated: !holiday.celebrated}),\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      credentials: \"include\"\n    }).then(res => res.json())\n    .then(resJson => {\n      // console.log(resJson)\n      const copyHolidays = [...this.state.holidays]\n      const findIndex = this.state.holidays.findIndex(\n        holiday => holiday._id === resJson._id)\n      copyHolidays[findIndex].celebrated = resJson.celebrated\n      this.setState({\n        holidays: copyHolidays\n      })\n    })\n  }\n\n  deleteHoliday = (id) => {\n      // console.log(id)\n      fetch(baseUrl + '/holidays/' + id, {\n      method: 'DELETE',\n      credentials: \"include\"\n    }).then( res => {\n      // console.log(res)\n      // if I checked for a 200 response code\n      const findIndex = this.state.holidays.findIndex(holiday => holiday._id === id)\n      const copyHolidays = [...this.state.holidays]\n      copyHolidays.splice(findIndex, 1)\n      this.setState({\n        holidays: copyHolidays\n      })\n    })\n  }\n\n  addLike = (holiday) => {\n    // console.log(holiday)\n    fetch(baseUrl + '/holidays/' + holiday._id, {\n      method: 'PUT',\n      body: JSON.stringify({ likes: holiday.likes + 1}),\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      credentials: \"include\"\n    }).then(res => res.json())\n    .then(resJson => {\n      // console.log(resJson)\n      const copyHolidays = [...this.state.holidays]\n      const findIndex = this.state.holidays.findIndex(holiday => holiday._id === resJson._id)\n      copyHolidays[findIndex].likes = resJson.likes\n      this.setState({\n        holidays: copyHolidays\n      })\n    })\n  }\n\n  // for more on async functions\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function\n  handleSubmit = async (e) => {\n    e.preventDefault()\n    const url = baseUrl + '/holidays/' + this.state.holidayToBeEdited._id\n    try{\n      const response = await fetch( url , {\n        method: 'PUT',\n        body: JSON.stringify({\n          name: e.target.name.value,\n          description: e.target.description.value\n        }),\n        headers: {\n          'Content-Type' : 'application/json'\n        },\n        credentials: \"include\"\n      })\n\n      if (response.status === 200){\n        const updatedHoliday = await response.json()\n        //console.log(updatedHoliday)\n        const findIndex = this.state.holidays.findIndex(holiday => holiday._id === updatedHoliday._id)\n        const copyHolidays = [...this.state.holidays]\n        copyHolidays[findIndex] = updatedHoliday\n        this.setState({\n          holidays: copyHolidays,\n          modalOpen:false\n        })\n      }\n    }\n    catch(err){\n      console.log('Error => ', err);\n    }\n  }\n\n handleChange = (e)=>{\n   this.setState({\n     [e.target.name]: e.target.value\n   })\n }\n\n  showEditForm = (holiday)=>{\n    this.setState({\n      modalOpen:true,\n      name: holiday.name,\n      description: holiday.description,\n      holidayToBeEdited:holiday\n    })\n  }\n\n\n  // component lifecycle flowchart\n  // https://levelup.gitconnected.com/componentdidmakesense-react-lifecycle-explanation-393dcb19e459\n  componentDidMount() {\n    this.getHolidays()\n  }\n\n  render() {\n    return (\n      <div className=\"App\">\n        <Nav loginUser={this.loginUser} register={this.register}/>\n        <h1>Holidays! Celebrate! </h1>\n        <NewForm baseUrl={baseUrl} addHoliday={ this.addHoliday }/>\n        <table>\n          <tbody>\n            { this.state.holidays.map((holiday, i) => {\n                return (\n                  <tr key={holiday._id}>\n                    <td onDoubleClick={() => this.toggleCelebrated(holiday)}\n                     className={ holiday.celebrated ? 'celebrated' : null }>\n                     { holiday.name }\n                    </td>\n                    <td key={i}> {holiday.description} </td>\n                    <td>{holiday.likes}</td>\n                    <td onClick={() => { this.addLike(holiday)}}>LIKE</td>\n                    <td onClick={() => { this.showEditForm(holiday)}}>Show Edit Form</td>\n                    <td onClick={() => this.deleteHoliday(holiday._id)}>X</td>\n                  </tr>\n                )\n              })\n            }\n          </tbody>\n        </table>\n        <br/>\n          {\n            this.state.modalOpen &&\n\n            <form onSubmit={this.handleSubmit}>\n              <label>Name: </label>\n              <input name=\"name\" value={this.state.name} onChange={this.handleChange}/> <br/>\n\n              <label>Description: </label>\n              <input name=\"description\" value={this.state.description} onChange={this.handleChange}/>\n\n              <button>submit</button>\n\n            </form>\n          }\n      </div>\n    );\n  }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}